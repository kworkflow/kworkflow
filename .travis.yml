language: bash
os: linux
dist: bionic

# Prepare for dependencies installation
before_install:
  - sudo apt-get -y update

# Install dependencies
install:
  - >
    sudo apt-get -y install libguestfs-tools qemu bash git
    python-docutils dash shunit2 fish python3-sphinx

# Prepare to execute tests
before_script:
  - ./run_tests.sh prepare

# Execute tests, docs build and kw installation to check for errors
script:
  - ./run_tests.sh
  - ./setup.sh --docs --force
  - ./setup.sh -i --force

notifications:
  email:
    on_success: never
    on_failure: always
